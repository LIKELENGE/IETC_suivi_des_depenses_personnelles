<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Ajouter une d√©pense</title>
</head>
<body>
    <h1>Ajouter une d√©pense</h1>

    <!-- üîπ √âtape 1 : S√©lection de la cat√©gorie -->
    <form method="GET" action="{{ url_for('depense.ajouter_depense') }}">
        <label for="id_categorie">Choisissez une cat√©gorie :</label>
        <select name="id_categorie" required>
            {% for categorie in categories %}
                <option value="{{ categorie.id_categorie }}"
                    {% if categorie.id_categorie == selected_id_categorie %}selected{% endif %}>
                    {{ categorie.description }}
                </option>
            {% endfor %}
        </select>
        <input type="hidden" name="mois" value="{{ mois }}">
        <input type="hidden" name="annee" value="{{ annee }}">
        <button type="submit">Afficher le quota</button>
    </form>

    <br>

    {% if quota_restant is defined %}
        <!-- üî∏ Affichage du quota disponible -->
        <p><strong>Quota restant :</strong> {{ quota_restant }} ‚Ç¨</p>

        {% if erreur %}
            <p style="color: red;">{{ erreur }}</p>
        {% endif %}

        {% if message %}
            <p style="color: green;">{{ message }}</p>
        {% endif %}

        <!-- üîπ √âtape 2 : Formulaire pour ajouter la d√©pense -->
        <form method="POST" action="{{ url_for('depense.ajouter_depense') }}">
            <input type="hidden" name="id_categorie" value="{{ selected_id_categorie }}">
            <input type="hidden" name="mois" value="{{ mois }}">
            <input type="hidden" name="annee" value="{{ annee }}">

            <label for="montant">Montant (‚Ç¨) :</label>
            <input type="number" step="0.01" name="montant" required><br>

            <label for="date_transaction">Date :</label>
            <input type="date" name="date_transaction" required><br>

            <label for="heure_transaction">Heure :</label>
            <input type="time" name="heure_transaction" required><br>

            <label for="libelle">Libell√© :</label>
            <input type="text" name="libelle"><br>

            <label for="deductible_fiscalement">D√©ductible fiscalement :</label>
            <select name="deductible_fiscalement">
                <option value="True">Oui</option>
                <option value="False">Non</option>
            </select><br><br>

            <button type="submit">Ajouter la d√©pense</button>
        </form>
    {% endif %}
</body>
</html>
